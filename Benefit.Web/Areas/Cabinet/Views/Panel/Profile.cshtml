@model Benefit.Domain.Models.ApplicationUser

@{
    ViewBag.Title = "Профіль";
    Layout = "~/Areas/Cabinet/Views/Shared/_CabinetLayout.cshtml";
}
@section PartnerHead
{
    @Html.Partial("_PartnerHead", Model)
}
@section scripts
{

    <script src="~/Areas/Admin/assets/js/jquery.mask.min.js"></script>
    <script src="~/Scripts/address.js"></script>
    <script>
        $(function () {
            $("body").on("click", "#partner-referal", function () {
                $(this).select();
            });
            try {
                $('.number-input').mask("999999");
            } catch (err) {
            }

            SetRegionsAutocomplete();
        });
    </script>
}
<div class="partner_main col-lg-9 col-md-9 col-sm-9 col-xs-9">
    <div id="flashMessage">
        @if (ViewBag.SuccessMessage != null || TempData["SuccessMessage"] != null)
        {
            <p class="alert alert-success">
                @{
            var message = ViewBag.SuccessMessage ?? TempData["SuccessMessage"];
                }
                @message
            </p>
        }
        @if (ViewBag.ErrorMessage != null || TempData["ErrorMessage"] != null)
        {
            <p class="alert alert-danger">
                @{
            var message = ViewBag.ErrorMessage ?? TempData["ErrorMessage"];
                }
                @message
            </p>
        }
    </div>

    <ul class="profile_menu nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#base">Основна</a></li>
        @*        <li><a data-toggle="tab" href="#addition">Додатково</a></li>*@
        <li><a data-toggle="tab" href="#address">Адреси доставки</a></li>
        <li><a data-toggle="tab" href="#security">Безпека</a></li>
        <li><a data-toggle="tab" href="#change_data">Зміна даних</a></li>
    </ul>

    <div class="tab-content">
        <div id="base" class="base tab-pane fade in active">
            <p class="profile_title">Прізвище, ім’я, по-батькові</p>
            <p class="profile_title_description">@Model.FullName</p>
            <p class="profile_title">Електронна пошта</p>
            <p class="profile_title_description">@Model.Email</p>
            <p class="profile_title">Телефон</p>
            <p class="profile_title_description">@Model.PhoneNumber</p>
            <p class="profile_title">Реферальний код</p>
            <p class="profile_title_description">@Model.ExternalNumber</p>
            @using (Html.BeginForm("Profile", "Panel"))
            {
                <p class="profile_title">Реферальне посилання</p>
                <p class="profile_title">
                    <input id="partner-referal" type="text" value="@Url.RouteUrl("OldRegister", new { id = Model.ExternalNumber }, Request.Url.Scheme)" readonly />
                </p>
                <hr />

                @Html.ValidationSummary()
                <p class="profile_title">Номер картки</p>
                <p class="profile_title">
                    @if (string.IsNullOrEmpty(Model.CardNumber))
                    {
                        <input id="partner-referal" class="number-input" name="CardNumber" type="text" value="@Model.CardNumber" />
                    }
                    else
                    {
                        <input id="partner-referal" name="CardNumber" type="text" value="@Model.CardNumber" readonly />
                    }
                </p>

                <p class="profile_title">
                    <label for="profile_name">Місто / Населений пункт</label>
                    <input id="profile_name" class="regionSearch" type="text" value="@Model.Region.Name_ua">
                    <input id="profile_name" name="RegionId" type="hidden" value="@Model.RegionId">
                    <label for="profile_address">Адреса</label>
                    <input id="profile_address" name="Address" type="text" value="@Model.Address">
                </p>

                <input type="submit" class="btn btn-success font-white" value="Зберегти дані" />

                if (Model.IsCardVerified)
                {
                    <img src="~/Content/img/kartka_verifikovana.png" />
                }
                else
                {
                    <p class="verification_data">Для отримання можливості взяти участь у плані винагород<br> необхідно пройти процедуру верифікації бонусної картки</p>
                    <a class="profile_verification" href="@Url.Action("VerifyCard")">Верифікація картки</a>
                }

                <p class="verification_data">Для операцій по перерахунку бонусів чи виведення їх в готівку<br> в цілях безпеки та згідно чинного законодавства України<br> вам потрібно пройти верифікацію акаунту</p>

                <button type="button" class="profile_verification">Верифікація акаунту</button>
            }

        </div>

        @*<div id="addition" class="addition tab-pane fade">
                <form class="profile_addition_form">
                    <label for="profile_birthday">Дата народження</label>
                    <input onkeyup="this.value=this.value.replace(/[^\d\.]+/g,'')" id="profile_birthday" type="text" placeholder="18.04.1994">

                    <label for="profile_sex">Стать</label>
                    <select name="profile_sex" id="profile_sex">
                        <option selected>жіноча</option>
                        <option>чоловіча</option>
                    </select>

                    <label for="profile_aducation">Освіта</label>
                    <input id="profile_aducation" type="text" placeholder="базова вища">

                    <label for="profile_job">Професія</label>
                    <input id="profile_job" type="text" placeholder="викладач">

                    <label for="profile_family">Сімейний статус</label>
                    <input id="profile_family" type="text" placeholder="Заміжня">

                    <label for="profile_children">Діти</label>
                    <input id="profile_children" type="text" placeholder="1">

                </form>
            </div>*@

        <div id="address" class="address tab-pane fade">
            <p class="profile_adress_title">Адреси доставки</p>
            @foreach (var address in Model.Addresses)
            {
                <div class="address_block">
                    <p class="adress_name">@address.FullName</p>
                    <p class="adress_main">@(address.Region.Name_ua + ", " + address.AddressLine)</p>
                    <p class="adress_phone">@address.Phone</p>
                    <a class="address_adit" href="@Url.Action("UserAddress", new { id = address.Id })">Редагувати</a>
                    <a class="address_delete">Видалити</a>
                </div>
            }
            <a class="address_add" href="@Url.Action("UserAddress")">Додати нову адресу</a>
        </div>

        <div id="security" class="security tab-pane fade">
            <button class="change_password">змінити пароль</button>
            <button class="change_pin">змінити пін-код</button>
            <p class="security_description">Пін-код використовується під час проведення будь-яких фінансових операцій, які пов’язані із використанням бонусів.</p>
            <p class="security_description">При зміні паролю чи пін-коду необхідно перейти за посиланням, яке буде відправлено компанією на вашу електронну пошту.</p>
        </div>

        <div id="change_data" class="change_data tab-pane fade">
            <form class="profile_change_data_form">
                <textarea placeholder="Введіть дані, які необхідно змінити.
Та вкажіть причину зміни."></textarea>
                <button class="request_change_data">Подати запит на зміну персональних даних</button>
            </form>
        </div>
    </div>
</div>
