@using Benefit.Common.Constants
@model Benefit.DataTransfer.ViewModels.NavigationEntities.CategoriesViewModel
@{
    ViewBag.SellerUrlName = Model.Seller.UrlName;
    ViewBag.Title = string.Format("{0} - {1}", Model.Seller.Name, Model.Category == null ? Model.Seller.CatalogButtonName : Model.Category.Name);
    ViewBag.SellerUrl = Model.Seller.UrlName;
    ViewBag.MainContainerClass = "full_content full_content_provider";
}
@section meta
{
    <meta name="description" content="@(Model.Category == null ? string.Empty : Model.Category.Description)">
}
@section LeftAside
{
    <div class="vertical_menu padding-bottom-15 clear-fix" id="right-menu" data-seller-url="@(Model.Seller == null ? "" : Model.Seller.UrlName)" data-category-id="@(Model.Category == null ? "" : Model.Category.Id)">
    </div>
}
@{
    var closingDivRendered = false;
}
<div class="clearfix categories-catalog">
    @Html.Partial("_BreadcrumbsPartial", Model.Breadcrumbs)

    <header class="title-page">
        <h1 class="pab-h1">
            @string.Format("{0} - {1}", Model.Seller.Name, Model.Category == null ? Model.Seller.CatalogButtonName : Model.Category.Name)
        </h1>
    </header>

    @if (Model.Items.Any())
    {
        @:<div class="clearfix">
        foreach (var category in Model.Items)
        {
            if (category.ChildCategories.Any())
            {
                if (!closingDivRendered)
                {
                    @:</div>
                    closingDivRendered = true;
                }
                <div class="clearfix">
                    @{
                var counter = 0;
                var childCount = category.ChildCategories.Count;
                    }
                    <h2 class="pab-h2 padding-bottom-15">
                        @if (Model.Category != null && Model.Category.Id == category.Id)
                        {
                            <span>@category.Name</span>
                        }
                        else
                        {
                            <a class="pab-h2-link" href="@Url.RouteUrl(RouteConstants.SellerCatalogRouteName, new {sellerUrl = ViewBag.SellerUrlName, categoryUrl = category.UrlName})" title="@category.Description">
                                @category.Name
                            </a>
                        }
                    </h2>
                    @foreach (var child in category.ChildCategories)
                    {
                        @Html.Partial("~/Views/Catalog/_CategoryPartial.cshtml", child)
                    }
                </div>
            }
            else
            {
                @Html.Partial("~/Views/Catalog/_CategoryPartial.cshtml", category)
            }
        }
    }
</div>
