@using Benefit.Domain.Models
@model Benefit.DataTransfer.ViewModels.SellerDetailsViewModel
@{
    ViewBag.Title = Model.Seller.Name;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="clearfix">
    @Html.Partial("_BreadcrumbsPartial", Model.Breadcrumbs)

    <h2 class="margin-bottom-5">@Model.Seller.Name</h2>
    @{
        var specifics = @Model.Seller.SellerCategories.Select(entry => entry.Category.ParentCategory).Distinct();
        var result = (from specific in specifics where !specifics.Select(entry => entry.Id).Contains(specific.ParentCategoryId) select specific.Name).ToList();
        var specificsStr = string.Join(" / ", result);
    }
    <p class="organization_type">@specificsStr</p>
    <div class="organization_slider_wrap">
        <div id="organization_slider" class="organization_slider">
            @foreach (var image in Model.Seller.Images.Where(entry => entry.ImageType == ImageType.SellerGallery))
            {
                <img class="item" src="~/Images/SellerGallery/@Model.Seller.Id/@image.ImageUrl" />
            }
        </div>
        @if (Model.Seller.IsBenefitCardActive)
        {
            <div class="benefit_card_bage"></div>
        }
    </div>

    <div class="organization_submenu">
        <div class="organization_bonus">
            -@Model.Seller.UserDiscount %
        </div>
        @if (Model.Seller.Addresses.Any())
        {
            <div class="organization_adress">
                @{
            var address = Model.Seller.Addresses.FirstOrDefault();
                }
                @if (address != null)
                {
                    <div class="provider_address">
                        <span>
                            @address.Region.Name_ua
                            @if (!string.IsNullOrEmpty(address.AddressLine))
                            {
                                <br />
                                <span>@address.AddressLine</span>
                            }
                        </span>
                    </div>
                }
            </div>
        }

        <div class="organization_hours">
            @{
                //todo: refactor schedules
                var monSchedule = Model.Seller.Schedules.First(entry => entry.Day == DayOfWeek.Monday);
                var satSchedule = Model.Seller.Schedules.First(entry => entry.Day == DayOfWeek.Saturday);
                var sunSchedule = Model.Seller.Schedules.First(entry => entry.Day == DayOfWeek.Sunday);
            }
            Пн.-Пт.
            @if (monSchedule.StartHour == null)
            {
                <span>вихідний</span>
            }
            else
            {
                <span>@monSchedule.StartHour:00 - @monSchedule.EndHour:00</span>
            }
            <br />
            Сб.
            @if (satSchedule.StartHour == null)
            {
                <span>вихідний</span>
            }
            else
            {
                <span>@satSchedule.StartHour:00 - @satSchedule.EndHour:00</span>
            }
            <br />
            Нд.
            @if (sunSchedule.StartHour == null)
            {
                <span>вихідний</span>
            }
            else
            {
                <span>@sunSchedule.StartHour:00 - @sunSchedule.EndHour:00</span>
            }
        </div>
        <a class="goto_menu" href="#">@Model.Seller.CatalogButtonName</a>
    </div>

    <ul class="tab_menu nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#about_org">Про нас</a></li>
        <li><a data-toggle="tab" href="#map_org">На карті</a></li>
        <li><a data-toggle="tab" href="#addition_org">Додатково</a></li>
        <li><a data-toggle="tab" href="#delivery_org">Доставка</a></li>
        <li><a data-toggle="tab" href="#recall_org">Відгуки</a></li>
    </ul>

    <div class="tab-content">
        <div id="about_org" class="about_org tab-pane fade in active">
            @Html.Raw(Model.Seller.Description)
        </div>

        <div id="addition_org" class="addition_org tab-pane fade">
            <ul>
                <li>Benefit Card</li>
                <li>Wi-Fi</li>
                <li>Оплата карткою</li>
                <li>Парковка </li>
                <li>Дитяча кімната</li>
                <li>Vip кімната</li>
                <li>Тераса</li>
            </ul>
        </div>
        <div id="map_org" class="addition_org tab-pane fade">
            @{
                var mapAddress = Model.Seller.Addresses.FirstOrDefault();
                var addressStr = string.Empty;
                if (mapAddress != null)
                {
                    addressStr = mapAddress.Region.Name_ua + "," + mapAddress.AddressLine;
                }
            }
            <iframe style="border:0" src="https://www.google.com/maps/embed/v1/place?q=@addressStr&amp;key=AIzaSyACynVfj28_Sng9qeoClqX8LygAonDC4LE " allowfullscreen="" width="1000" height="450" frameborder="0"></iframe>
        </div>

        <div id="delivery_org" class="delivery_org tab-pane fade">
            <div>
                @Html.Raw(Model.Seller.ShippingDescription)
            </div>
            @* <p>
                    @foreach (var shipping in Model.Seller.ShippingMethods)
                    {
                        <p>
                            Доставка по <b>@shipping.Region.Name_ua</b> службою <b>@shipping.Name</b>
                            @if (shipping.CostBeforeFree == 0)
                            {
                                <span>безкоштовна</span>
                            }
                            else
                            {
                                <span>
                                    становить @shipping.CostBeforeFree грн, від @shipping.FreeStartsFrom - безкоштовна
                                </span>
                            }
                        </p>
                    }
                </p>*@
        </div>

        <div id="recall_org" class="recall_org tab-pane fade">
            <form>
                <label class="recall_label" for="recall">Залишити відгук</label>
                <textarea class="recall_text" id="recall" placeholder="Залишити відгук може лише авторизований користувач"></textarea>
                <p class="recall_register_notice"><a href="">Увійдіть</a> або <a href="">зареєструйтесь,</a> щоб залишити коментар</p>
            </form>

            @*<div class="recall_title_wrap clearfix">
                    <div class="recall_title">Відгуки про «Greenwich Lounge Bar»</div>
                    <div class="recall_rating">
                        <span class="rating_star good"></span>
                        <span class="rating_all">15 відгуків</span>
                    </div>
                </div>

                <div class="recall_item">
                    <div class="recall_item_head">
                        <div class="recall_name">Евгеній</div>
                        <div class="recall_time">12.04.16 в 13:00</div>
                    </div>
                    <span class="rating_star good"></span>
                    <p class="recall_main">Ресторан має вишукане оформлення та першокласну кухню.Персонал дуже ввічливий та тактовний. Цей заклад харчування мій улюблений,поміж усіх інших. Всім раджу завітати в цей ресторан.</p>
                </div>

                <div class="recall_item">
                    <div class="recall_item_head">
                        <div class="recall_name">Михайло</div>
                        <div class="recall_time">12.04.16 в 13:00</div>
                    </div>
                    <span class="rating_star top"></span>
                    <p class="recall_main">Вчора були в "Greenwich Lounge Bar", інтер'єр спокійний , затишний, ненав'язлива музика, страви смачнющі, адміністратор дуже приємна і привітна дівчина. Я думаю, що у Мукачеві немає місць рівних цьому, завітайте, не пожалієте, ми з чоловіком залишились довольні!!! Дякуємо!!!</p>
                </div>*@
        </div>
    </div>
</div>
