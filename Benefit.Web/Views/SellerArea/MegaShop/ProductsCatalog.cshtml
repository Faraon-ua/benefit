@using Benefit.Common.Constants
@using Benefit.Domain.Models
@using Benefit.Web.Helpers
@model Benefit.DataTransfer.ViewModels.NavigationEntities.ProductsViewModel

@{
    ViewBag.Title = Model.Category.Name;
    Layout = "_SellerLayout.cshtml";
    var seller = ViewBag.Seller as Seller;
    var isFavorites = (Model.Category != null && Model.Category.UrlName == "favorites");
    ViewBag.IsFavorites = isFavorites;
}
@section styles
{
    <link href="~/Content/seller/megashop/bootstrap-slider.css" rel="stylesheet" />
    <link href="~/Content/css/font-awesome.min.css" rel="stylesheet" />
    <link href="~/Content/css/bootstrap.modal.css" rel="stylesheet" />
}
@section scripts
{
    <script src="~/Scripts/seller/megashop/jquery-ui.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/bootstrap-slider.min.js"></script>
    <script>
        var productOptionsUrl = '@Url.Action("GetProductOptions", "Tovar")';
        var addToCartUrl = '@Url.Action("AddProduct", "Cart")';
        var getProductsUrl = '@Url.Action("GetProducts", "Catalog")';
        var addToFavoritesUrl =
            '@Html.Raw(Url.Action("AddToFavorites", "Tovar", new {returnUrl = Request.Url.PathAndQuery}))';
        var removeFromFavoritesUrl = '@Url.Action("RemoveFromFavorites", "Tovar")';
        var showMessagePopupUrl = '@Url.Action("ShowMessagePopup", "Home")';
        var hasCategory = "@((Model.Category == null).ToString().ToLower())" === 'false';
        var categoryId = '@Model.Category.Id';
        var categoryUrlName = '@Model.Category.UrlName.ToLower()';
        var sellerId = '@seller.Id';
        var pagesCount = parseInt('@Model.PagesCount');
        var takePerPage = parseInt('@ListConstants.DefaultTakePerPage');
        var productTemplateLayout = 1;
    </script>
    <script src="~/Scripts/v3/products.js"></script>
    <script src="~/Scripts/v3/product-filters.js"></script>
}
@section LeftAside
{
    <div class="filters_block">
        <div class="filters_heading fn_switch md-hidden">
            <span data-language="filters">Фильтр</span>
            <i class="angle_icon"></i>
        </div>
        <div class="filters mobile-hidden">
            @Html.Partial("~/Views/Catalog/_ProductFilters.cshtml", Model.ProductParameters)
        </div>
    </div>
}
<div class="col-md-8 col-xl-9 content">
    @Html.Partial("~/views/sellerarea/megashop/_BreadcrumbsPartial.cshtml", Model.Breadcrumbs)

    <div class="fn_ajax_content">

        <h1 class="h1"><span data-category="3">@Model.Category.Name</span>  </h1>
        @if (Model.IsFavorites)
        {
            <div class="padding-15">
                <button id="remove-all" type="button" class="button btn-danger no-border">Видалити всі</button>
                <button id="remove-selected" type="button" class="button no-border margin-left-30">Видалити обрані</button>
                <button id="buy-all" type="button" class="button btn-success no-border margin-left-30">Купити всі</button>
            </div>
        }
        @if (RouteDataHelper.ControllerName.ToLower() != "search" && !Model.IsFavorites)
        {
            <div class="fn_products_sort clearfix sort_header margin-top-10 visible-lg">
                <div class="sort_filter visible-lg filter-section" data-filter-name="sort">
                    <span style="display: table-cell; vertical-align: middle;">Показати спочатку: </span>

                    <a href="" data-sort-value="Rating" class="sort_btn" rel="nofollow">
                        <span class="padding-10">По рейтингу</span>
                    </a>
                    <a href="" data-sort-value="NameAsc" class="sort_btn" rel="nofollow">
                        <span class="padding-10">По алфавіту</span>
                    </a>
                    <a href="" data-sort-value="PriceAsc" class="sort_btn" rel="nofollow">
                        <span class="padding-10">Дешеві</span>
                    </a>
                    <a href="" data-sort-value="PriceDesc" class="sort_btn" rel="nofollow">
                        <span class="padding-10">Дорогі</span>
                    </a>
                </div>
            </div>
        }

        <div id="fn_products_content" class="fn_categories products row products-wrapper">
            @{
                var take = Model.IsFavorites ? Model.Items.Count : ListConstants.DefaultTakePerPage;
            }
            @foreach (var product in Model.Items.Take(take))
            {
                @Html.Partial("~/Views/SellerArea/megashop/_ProductPartial.cshtml", product)
            }
        </div>
        @if (!Model.IsFavorites)
        {
            if (Model.Items.Count > ListConstants.DefaultTakePerPage)
            {
                <div class="ajax_load_btn" data-page="1">
                    <span class="more_text_ajax">Показати ще</span>
                </div>
            }
            if (Model.PagesCount > 1)
            {
                <ul class="pagination">
                    <li class="page_item" data-page="0" style="display: none;">
                        <a class="page_link paging prev" href="#" data-page="0"><< Назад</a>
                    </li>
                    <li class="page_item active" data-page="0">
                        <a class="page_link paging" href="#" data-page="0">1</a>
                    </li>
                    @for (int i = 2; i <= Model.PagesCount; i++)
                    {
                        <li class="page_item">
                            <a class="page_link paging" href="#" data-page="@(i - 1)">@i</a>
                        </li>
                    }
                    <li class="page_item" data-page="1">
                        <a class="page_link paging next" href="#" data-page="1">Вперед >></a>
                    </li>
                </ul>
            }
        }
        <br style="clear: both;" />
    </div>
</div>
<div class="modal-container"></div>
